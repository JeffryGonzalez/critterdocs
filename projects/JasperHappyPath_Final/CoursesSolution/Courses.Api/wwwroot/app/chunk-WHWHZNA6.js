import{$ as xe,A as y,B as z,C as le,D as ce,E as ee,F as j,G as L,H as Ce,I as Ee,J as W,K as pt,L as _,M as Y,N as Q,O as vt,P as gt,Q as yt,R as St,S as bt,U as qe,V as se,W as he,X as Mt,Y as De,Z as Ae,_ as J,a as l,aa as ke,b as h,ba as _t,c as rt,d as st,e as C,f as ot,fa as Vt,g as k,ga as Ft,h as at,ha as wt,i as Ge,ia as Ct,j as I,k as O,l as lt,m as He,n as we,o as ct,p as ut,q as dt,r as F,s as T,t as ft,u as K,v as N,w as mt,x as ht,y as D,z as g}from"./chunk-ALT4OPQJ.js";var Te=(()=>{let i=class i{constructor(){this.label=J.required(),this.link=J.required(),this.makeActive=J(!1,{transform:ke})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-link-button"]],inputs:{label:[1,"label"],link:[1,"link"],makeActive:[1,"makeActive"]},decls:3,vars:11,consts:[["linkId","routerLinkActive"],[1,"btn","hover:ring-2","hover:ring-primary",3,"routerLinkActive","routerLink"]],template:function(n,s){if(n&1&&(g(0,"a",1,0),_(2),y()),n&2){let o=W(1);pt("btn-sm",s.makeActive())("btn-primary",o.isActive||s.makeActive())("btn-ghost",!o.isActive&&!s.makeActive())("underline",o.isActive||s.makeActive()),D("routerLinkActive","")("routerLink",s.link()),F(2),Q("",s.label()," ")}},dependencies:[wt,Ct],encapsulation:2,changeDetection:0});let t=i;return t})();function Et(t){let i=qe(()=>t());return Qt(i)?new Proxy(t,{get(r,e){return e in i?(ct(r[e])||Object.defineProperty(r,e,{value:se(()=>r()[e]),configurable:!0}),Et(r[e])):r[e]}}):t}var qt=[WeakSet,WeakMap,Promise,Date,Error,RegExp,ArrayBuffer,DataView,Function];function Qt(t){if(t===null||typeof t!="object"||Jt(t))return!1;let i=Object.getPrototypeOf(t);if(i===Object.prototype)return!0;for(;i&&i!==Object.prototype;){if(qt.includes(i.constructor))return!1;i=Object.getPrototypeOf(i)}return i===Object.prototype}function Jt(t){return typeof t?.[Symbol.iterator]=="function"}var Yt=new WeakMap,B=Symbol("STATE_SOURCE");function Z(t,...i){t[B].update(r=>i.reduce((e,n)=>l(l({},e),typeof n=="function"?n(e):n),r)),ei(t)}function Xt(t){return t[B]()}function Zt(t){return Yt.get(t[B])||[]}function ei(t){let i=Zt(t);for(let r of i){let e=qe(()=>Xt(t));r(e)}}function Dt(...t){let i=[...t],r=typeof i[0]=="function"?{}:i.shift(),e=i;return(()=>{class s{constructor(){let a=e.reduce((S,b)=>b(S),ti()),{stateSignals:d,props:m,methods:f,hooks:u}=a,c=l(l(l({},d),m),f);this[B]=a[B];for(let S of Reflect.ownKeys(c))this[S]=c[S];let{onInit:v,onDestroy:p}=u;v&&v(),p&&k(we).onDestroy(p)}static \u0275fac=function(d){return new(d||s)};static \u0275prov=ot({token:s,factory:s.\u0275fac,providedIn:r.providedIn||null})}return s})()}function ti(){return{[B]:ut({}),stateSignals:{},props:{},methods:{},hooks:{}}}function Qe(t){return i=>{let r=t(l(l(l({[B]:i[B]},i.stateSignals),i.props),i.methods));return Reflect.ownKeys(r),h(l({},i),{props:l(l({},i.props),r)})}}function At(t){return Qe(t)}function xt(t){return i=>{let r=l(l(l({[B]:i[B]},i.stateSignals),i.props),i.methods),e=typeof t=="function"?t(r):t,n=s=>{let o=e[s],a=i.hooks[s];return o?()=>{a&&a(),o(r)}:a};return h(l({},i),{hooks:{onInit:n("onInit"),onDestroy:n("onDestroy")}})}}function kt(t){return i=>{let r=t(l(l(l({[B]:i[B]},i.stateSignals),i.props),i.methods));return Reflect.ownKeys(r),h(l({},i),{methods:l(l({},i.methods),r)})}}function Tt(t){return i=>{let r=typeof t=="function"?t():t,e=Reflect.ownKeys(r);i[B].update(s=>l(l({},s),r));let n=e.reduce((s,o)=>{let a=se(()=>i[B]()[o]);return h(l({},s),{[o]:Et(a)})},{});return h(l({},i),{stateSignals:l(l({},i.stateSignals),n)})}}var U=Dt(Tt({flash:"",hasError:!1}),Qe(()=>({_resource:De({loader:()=>fetch("/api/courses").then(i=>i.json()),defaultValue:[]})})),At(t=>({courses:se(()=>t._resource.value()),isLoading:se(()=>t._resource.isLoading()),error:se(()=>t._resource.error())})),kt(t=>({clearFlash:()=>Z(t,{flash:"",hasError:!1}),delete:i=>C(null,null,function*(){(yield fetch(`/api/courses/${i}`,{method:"DELETE"})).ok?Z(t,{flash:"Course deleted successfully!",hasError:!1}):Z(t,{flash:"Failed to delete course",hasError:!0}),t._resource.reload()}),assignInstructor:(i,r)=>C(null,null,function*(){(yield fetch(`/api/courses/${i}/instructor`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instructor:r})})).ok?Z(t,{flash:`Instructor ${r} assigned successfully!`,hasError:!1}):Z(t,{flash:"Failed to assign instructor",hasError:!0}),t._resource.reload()}),reload:()=>t._resource.reload(),addCourse:i=>C(null,null,function*(){(yield fetch("/api/courses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).ok?Z(t,{flash:`Course ${i.title} added successfully!`,hasError:!1}):Z(t,{flash:"Failed to add course",hasError:!0}),t._resource.reload()})})),xt({onInit:t=>{he(()=>{if(t.flash()){let i=setTimeout(()=>{Z(t,{flash:"",hasError:!1})},5e3);return()=>clearTimeout(i)}return()=>null})}}));function ii(t,i){if(t&1&&(g(0,"div",1)(1,"span"),_(2),y()()),t&2){let r=L(2);F(2),Y(r.store.flash())}}function ni(t,i){if(t&1&&(g(0,"div",2)(1,"span"),_(2),y()()),t&2){let r=L(2);F(2),Y(r.store.flash())}}function ri(t,i){if(t&1&&(g(0,"div",0),K(1,ii,3,1,"div",1)(2,ni,3,1,"div",2),y()),t&2){let r=L();F(),N(r.store.hasError()?1:2)}}var It=(()=>{let i=class i{constructor(){this.store=k(U)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-flash"]],decls:1,vars:1,consts:[[1,"toast","toast-end","pb-4"],[1,"alert","alert-info"],[1,"alert","alert-success"]],template:function(n,s){n&1&&K(0,ri,3,1,"div",0),n&2&&N(s.store.flash()?0:-1)},encapsulation:2,changeDetection:0});let t=i;return t})();var Ot=(()=>{let i=class i{};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses"]],decls:7,vars:0,consts:[[1,"flex","flex-row","gap-4","mb-4"],["label","List Courses","link","list"],["label","Add Course","link","add"]],template:function(n,s){n&1&&(z(0,"app-flash"),g(1,"h1"),_(2,"Courses"),y(),g(3,"div",0),z(4,"app-link-button",1)(5,"app-link-button",2),y(),z(6,"router-outlet"))},dependencies:[Vt,Te,It],encapsulation:2,changeDetection:0});let t=i;return t})();var te=new WeakMap,ue=new WeakMap,ge={current:[]},Je=!1,ve=0,pe=new Set,Ie=new Map;function jt(t){let i=Array.from(t).sort((r,e)=>r instanceof G&&r.options.deps.includes(e)?1:e instanceof G&&e.options.deps.includes(r)?-1:0);for(let r of i){if(ge.current.includes(r))continue;ge.current.push(r),r.recompute();let e=ue.get(r);if(e)for(let n of e){let s=te.get(n);s&&jt(s)}}}function si(t){t.listeners.forEach(i=>i({prevVal:t.prevState,currentVal:t.state}))}function oi(t){t.listeners.forEach(i=>i({prevVal:t.prevState,currentVal:t.state}))}function Oe(t){if(ve>0&&!Ie.has(t)&&Ie.set(t,t.prevState),pe.add(t),!(ve>0)&&!Je)try{for(Je=!0;pe.size>0;){let i=Array.from(pe);pe.clear();for(let r of i){let e=Ie.get(r)??r.prevState;r.prevState=e,si(r)}for(let r of i){let e=te.get(r);e&&(ge.current.push(r),jt(e))}for(let r of i){let e=te.get(r);if(e)for(let n of e)oi(n)}}}finally{Je=!1,ge.current=[],Ie.clear()}}function R(t){ve++;try{t()}finally{if(ve--,ve===0){let i=Array.from(pe)[0];i&&Oe(i)}}}function Lt(t){return typeof t=="function"}var ie=class{constructor(i,r){this.listeners=new Set,this.subscribe=e=>{var n,s;this.listeners.add(e);let o=(s=(n=this.options)==null?void 0:n.onSubscribe)==null?void 0:s.call(n,e,this);return()=>{this.listeners.delete(e),o?.()}},this.prevState=i,this.state=i,this.options=r}setState(i){var r,e,n;this.prevState=this.state,(r=this.options)!=null&&r.updateFn?this.state=this.options.updateFn(this.prevState)(i):Lt(i)?this.state=i(this.prevState):this.state=i,(n=(e=this.options)==null?void 0:e.onUpdate)==null||n.call(e),Oe(this)}};var G=class t{constructor(i){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{let r=[],e=[];for(let n of this.options.deps)r.push(n.prevState),e.push(n.state);return this.lastSeenDepValues=e,{prevDepVals:r,currDepVals:e,prevVal:this.prevState??void 0}},this.recompute=()=>{var r,e;this.prevState=this.state;let{prevDepVals:n,currDepVals:s,prevVal:o}=this.getDepVals();this.state=this.options.fn({prevDepVals:n,currDepVals:s,prevVal:o}),(e=(r=this.options).onUpdate)==null||e.call(r)},this.checkIfRecalculationNeededDeeply=()=>{for(let s of this.options.deps)s instanceof t&&s.checkIfRecalculationNeededDeeply();let r=!1,e=this.lastSeenDepValues,{currDepVals:n}=this.getDepVals();for(let s=0;s<n.length;s++)if(n[s]!==e[s]){r=!0;break}r&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(let r of this._subscriptions)r()}),this.subscribe=r=>{var e,n;this.listeners.add(r);let s=(n=(e=this.options).onSubscribe)==null?void 0:n.call(e,r,this);return()=>{this.listeners.delete(r),s?.()}},this.options=i,this.state=i.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(i=this.options.deps){for(let r of i)if(r instanceof t)r.registerOnGraph(),this.registerOnGraph(r.options.deps);else if(r instanceof ie){let e=te.get(r);e||(e=new Set,te.set(r,e)),e.add(this);let n=ue.get(this);n||(n=new Set,ue.set(this,n)),n.add(r)}}unregisterFromGraph(i=this.options.deps){for(let r of i)if(r instanceof t)this.unregisterFromGraph(r.options.deps);else if(r instanceof ie){let e=te.get(r);e&&e.delete(this);let n=ue.get(this);n&&n.delete(r)}}};function Xe(t,i){return typeof t=="function"?t(i):t}function oe(t,i){return Ze(i).reduce((e,n)=>{if(e===null)return null;if(typeof e<"u")return e[n]},t)}function ye(t,i,r){let e=Ze(i);function n(s){if(!e.length)return Xe(r,s);let o=e.shift();if(typeof o=="string"||typeof o=="number"&&!Array.isArray(s))return typeof s=="object"?(s===null&&(s={}),h(l({},s),{[o]:n(s[o])})):{[o]:n()};if(Array.isArray(s)&&typeof o=="number"){let a=s.slice(0,o);return[...a.length?a:new Array(o),n(s[o]),...s.slice(o+1)]}return[...new Array(o),n()]}return n(t)}function Pt(t,i){let r=Ze(i);function e(n){if(!n)return;if(r.length===1){let a=r[0];if(Array.isArray(n)&&typeof a=="number")return n.filter((f,u)=>u!==a);let o=n,{[a]:d}=o;return st(o,[rt(a)])}let s=r.shift();if(typeof s=="string"&&typeof n=="object")return h(l({},n),{[s]:e(n[s])});if(typeof s=="number"&&Array.isArray(n)){if(s>=n.length)return n;let a=n.slice(0,s);return[...a.length?a:new Array(s),e(n[s]),...n.slice(s+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return e(t)}var ai=/^(\d+)$/gm,li=/\.(\d+)(?=\.)/gm,ci=/^(\d+)\./gm,ui=/\.(\d+$)/gm,di=/\.{2,}/gm,Ye="__int__",je=`${Ye}$1`;function Ze(t){if(Array.isArray(t))return[...t];if(typeof t!="string")throw new Error("Path must be a string.");return t.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(ai,je).replace(li,`.${je}.`).replace(ci,`${je}.`).replace(ui,`.${je}`).replace(di,".").split(".").map(i=>i.indexOf(Ye)===0?parseInt(i.substring(Ye.length),10):i)}function Bt(t){return!(Array.isArray(t)&&t.length===0)}function Se(t,i){let{asyncDebounceMs:r}=i,{onChangeAsync:e,onBlurAsync:n,onSubmitAsync:s,onBlurAsyncDebounceMs:o,onChangeAsyncDebounceMs:a}=i.validators||{},d=r??0,m={cause:"change",validate:e,debounceMs:a??d},f={cause:"blur",validate:n,debounceMs:o??d},u={cause:"submit",validate:s,debounceMs:0},c=v=>h(l({},v),{debounceMs:0});switch(t){case"submit":return[c(m),c(f),u];case"blur":return[f];case"change":return[m];case"server":default:return[]}}function be(t,i){let{onChange:r,onBlur:e,onSubmit:n,onMount:s}=i.validators||{},o={cause:"change",validate:r},a={cause:"blur",validate:e},d={cause:"submit",validate:n},m={cause:"mount",validate:s},f={cause:"server",validate:()=>{}};switch(t){case"mount":return[m];case"submit":return[o,a,d,f];case"server":return[f];case"blur":return[a,f];case"change":default:return[o,f]}}var Le=t=>!!t&&typeof t=="object"&&"fields"in t;function ae(t,i){if(Object.is(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;if(t instanceof Map&&i instanceof Map){if(t.size!==i.size)return!1;for(let[n,s]of t)if(!i.has(n)||!Object.is(s,i.get(n)))return!1;return!0}if(t instanceof Set&&i instanceof Set){if(t.size!==i.size)return!1;for(let n of t)if(!i.has(n))return!1;return!0}let r=Object.keys(t),e=Object.keys(i);if(r.length!==e.length)return!1;for(let n of r)if(!e.includes(n)||!ae(t[n],i[n]))return!1;return!0}var et=({newFormValidatorError:t,isPreviousErrorFromFormValidator:i,previousErrorValue:r})=>t?{newErrorValue:t,newSource:"form"}:i?{newErrorValue:void 0,newSource:void 0}:r?{newErrorValue:r,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},tt=({formLevelError:t,fieldLevelError:i})=>i?{newErrorValue:i,newSource:"field"}:t?{newErrorValue:t,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function fi(t){let i=new Map;for(let r of t){let e=[...r.path??[]].map(n=>{let s=typeof n=="object"?n.key:n;return typeof s=="number"?`[${s}]`:s}).join(".").replace(/\.\[/g,"[");i.set(e,(i.get(e)??[]).concat(r))}return Object.fromEntries(i)}var $t=t=>{let i=fi(t);return{form:i,fields:i}},ne={validate({value:t,validationSource:i},r){let e=r["~standard"].validate(t);if(e instanceof Promise)throw new Error("async function passed to sync validator");if(e.issues)return i==="field"?e.issues:$t(e.issues)},validateAsync(e,n){return C(this,arguments,function*({value:t,validationSource:i},r){let s=yield r["~standard"].validate(t);if(s.issues)return i==="field"?s.issues:$t(s.issues)})}},Pe=t=>!!t&&"~standard"in t;var de={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function Me(t){function i(u,c,v,p){let S=e(u,c,v,p);({insert:()=>a(S,u,c),remove:()=>d(S),swap:()=>p!==void 0&&f(S,u,c,p),move:()=>p!==void 0&&m(S,u,c,p)})[v]()}function r(u,c){return`${u}[${c}]`}function e(u,c,v,p){let S=[r(u,c)];if(v==="swap")S.push(r(u,p));else if(v==="move"){let[b,M]=[Math.min(c,p),Math.max(c,p)];for(let V=b;V<=M;V++)S.push(r(u,V))}else{let b=t.getFieldValue(u),M=Array.isArray(b)?b.length:0;for(let V=c+1;V<M;V++)S.push(r(u,V))}return Object.keys(t.fieldInfo).filter(b=>S.some(M=>b.startsWith(M)))}function n(u,c){return u.replace(/\[(\d+)\]/,(v,p)=>{let S=parseInt(p,10);return`[${c==="up"?S+1:Math.max(0,S-1)}]`})}function s(u,c){(c==="up"?u:[...u].reverse()).forEach(p=>{let S=n(p.toString(),c),b=t.getFieldMeta(S);b?t.setFieldMeta(p,b):t.setFieldMeta(p,o())})}let o=()=>de,a=(u,c,v)=>{s(u,"down"),u.forEach(p=>{p.toString().startsWith(r(c,v))&&t.setFieldMeta(p,o())})},d=u=>{s(u,"up")},m=(u,c,v,p)=>{let S=new Map(Object.keys(t.fieldInfo).filter(b=>b.startsWith(r(c,v))).map(b=>[b,t.getFieldMeta(b)]));s(u,v<p?"up":"down"),Object.keys(t.fieldInfo).filter(b=>b.startsWith(r(c,p))).forEach(b=>{let M=b.replace(r(c,p),r(c,v)),V=S.get(M);V&&t.setFieldMeta(b,V)})},f=(u,c,v,p)=>{u.forEach(S=>{if(!S.toString().startsWith(r(c,v)))return;let b=S.toString().replace(r(c,v),r(c,p)),[M,V]=[t.getFieldMeta(S),t.getFieldMeta(b)];M&&t.setFieldMeta(b,M),V&&t.setFieldMeta(S,V)})};return{handleArrayFieldMetaShift:i}}function it(t){return{values:t.values??{},errorMap:t.errorMap??{},fieldMetaBase:t.fieldMetaBase??{},isSubmitted:t.isSubmitted??!1,isSubmitting:t.isSubmitting??!1,isValidating:t.isValidating??!1,submissionAttempts:t.submissionAttempts??0,isSubmitSuccessful:t.isSubmitSuccessful??!1,validationMetaMap:t.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}var _e=class{constructor(i){var r;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var e,n;let s=this.fieldMetaDerived.mount(),o=this.store.mount(),a=()=>{s(),o()};(n=(e=this.options.listeners)==null?void 0:e.onMount)==null||n.call(e,{formApi:this});let{onMount:d}=this.options.validators||{};return d&&this.validateSync("mount"),a},this.update=e=>{var n,s;if(!e)return;let o=this.options;this.options=e;let a=!!((s=(n=e.transform)==null?void 0:n.deps)!=null&&s.some((f,u)=>f!==this.prevTransformArray[u])),d=e.defaultValues&&!ae(e.defaultValues,o.defaultValues)&&!this.state.isTouched,m=!ae(e.defaultState,o.defaultState)&&!this.state.isTouched;!d&&!m&&!a||R(()=>{this.baseStore.setState(()=>it(Object.assign({},this.state,m?e.defaultState:{},d?{values:e.defaultValues}:{},a?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(e,n)=>{let{fieldMeta:s}=this.state,o=this.resetFieldMeta(s);e&&!n?.keepDefaultValues&&(this.options=h(l({},this.options),{defaultValues:e})),this.baseStore.setState(()=>{var a;return it(h(l({},this.options.defaultState),{values:e??this.options.defaultValues??((a=this.options.defaultState)==null?void 0:a.values),fieldMetaBase:o}))})},this.validateAllFields=e=>C(this,null,function*(){let n=[];return R(()=>{Object.values(this.fieldInfo).forEach(o=>{if(!o.instance)return;let a=o.instance;n.push(Promise.resolve().then(()=>a.validate(e,{skipFormValidation:!0}))),o.instance.state.meta.isTouched||o.instance.setMeta(d=>h(l({},d),{isTouched:!0}))})}),(yield Promise.all(n)).flat()}),this.validateArrayFieldsStartingFrom=(e,n,s)=>C(this,null,function*(){let o=this.getFieldValue(e),a=Array.isArray(o)?Math.max(o.length-1,0):null,d=[`${e}[${n}]`];for(let c=n+1;c<=(a??0);c++)d.push(`${e}[${c}]`);let m=Object.keys(this.fieldInfo).filter(c=>d.some(v=>c.startsWith(v))),f=[];return R(()=>{m.forEach(c=>{f.push(Promise.resolve().then(()=>this.validateField(c,s)))})}),(yield Promise.all(f)).flat()}),this.validateField=(e,n)=>{var s;let o=(s=this.fieldInfo[e])==null?void 0:s.instance;return o?(o.state.meta.isTouched||o.setMeta(a=>h(l({},a),{isTouched:!0})),o.validate(n)):[]},this.validateSync=e=>{let n=be(e,this.options),s=!1,o={};return R(()=>{var a,d;for(let f of n){if(!f.validate)continue;let u=this.runValidator({validate:f.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:c,fieldErrors:v}=$e(u),p=Be(f.cause);for(let S of Object.keys(this.state.fieldMeta)){let b=this.getFieldMeta(S);if(!b)continue;let{errorMap:M,errorSourceMap:V}=b,E=v?.[S],{newErrorValue:x,newSource:P}=et({newFormValidatorError:E,isPreviousErrorFromFormValidator:V?.[p]==="form",previousErrorValue:M?.[p]});P==="form"&&(o[S]=h(l({},o[S]),{[p]:E})),M?.[p]!==x&&this.setFieldMeta(S,$=>h(l({},$),{errorMap:h(l({},$.errorMap),{[p]:x}),errorSourceMap:h(l({},$.errorSourceMap),{[p]:P})}))}((a=this.state.errorMap)==null?void 0:a[p])!==c&&this.baseStore.setState(S=>h(l({},S),{errorMap:h(l({},S.errorMap),{[p]:c})})),(c||v)&&(s=!0)}let m=Be("submit");(d=this.state.errorMap)!=null&&d[m]&&e!=="submit"&&!s&&this.baseStore.setState(f=>h(l({},f),{errorMap:h(l({},f.errorMap),{[m]:void 0})}))}),{hasErrored:s,fieldsErrorMap:o}},this.validateAsync=e=>C(this,null,function*(){let n=Se(e,this.options);this.state.isFormValidating||this.baseStore.setState(m=>h(l({},m),{isFormValidating:!0}));let s=[],o;for(let m of n){if(!m.validate)continue;let f=Be(m.cause),u=this.state.validationMetaMap[f];u?.lastAbortController.abort();let c=new AbortController;this.state.validationMetaMap[f]={lastAbortController:c},s.push(new Promise(v=>C(this,null,function*(){let p;try{p=yield new Promise((V,E)=>{setTimeout(()=>C(this,null,function*(){if(c.signal.aborted)return V(void 0);try{V(yield this.runValidator({validate:m.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:c.signal},type:"validateAsync"}))}catch(x){E(x)}}),m.debounceMs)})}catch(V){p=V}let{formError:S,fieldErrors:b}=$e(p);b&&(o=o?l(l({},o),b):b);let M=Be(m.cause);for(let V of Object.keys(this.state.fieldMeta)){let E=this.getFieldMeta(V);if(!E)continue;let{errorMap:x,errorSourceMap:P}=E,$=o?.[V],{newErrorValue:H,newSource:re}=et({newFormValidatorError:$,isPreviousErrorFromFormValidator:P?.[M]==="form",previousErrorValue:x?.[M]});x?.[M]!==H&&this.setFieldMeta(V,A=>h(l({},A),{errorMap:h(l({},A.errorMap),{[M]:H}),errorSourceMap:h(l({},A.errorSourceMap),{[M]:re})}))}this.baseStore.setState(V=>h(l({},V),{errorMap:h(l({},V.errorMap),{[M]:S})})),v(o?{fieldErrors:o,errorMapKey:M}:void 0)})))}let a=[],d={};if(s.length){a=yield Promise.all(s);for(let m of a)if(m?.fieldErrors){let{errorMapKey:f}=m;for(let[u,c]of Object.entries(m.fieldErrors)){let v=d[u]||{},p=h(l({},v),{[f]:c});d[u]=p}}}return this.baseStore.setState(m=>h(l({},m),{isFormValidating:!1})),d}),this.validate=e=>{let{hasErrored:n,fieldsErrorMap:s}=this.validateSync(e);return n&&!this.options.asyncAlways?s:this.validateAsync(e)},this.getFieldValue=e=>oe(this.state.values,e),this.getFieldMeta=e=>this.state.fieldMeta[e],this.getFieldInfo=e=>{var n;return(n=this.fieldInfo)[e]||(n[e]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(e,n)=>{this.baseStore.setState(s=>h(l({},s),{fieldMetaBase:h(l({},s.fieldMetaBase),{[e]:Xe(n,s.fieldMetaBase[e])})}))},this.resetFieldMeta=e=>Object.keys(e).reduce((n,s)=>{let o=s;return n[o]=de,n},{}),this.setFieldValue=(e,n,s)=>{let o=s?.dontUpdateMeta??!1;R(()=>{o||this.setFieldMeta(e,a=>h(l({},a),{isTouched:!0,isDirty:!0,errorMap:h(l({},a?.errorMap),{onMount:void 0})})),this.baseStore.setState(a=>h(l({},a),{values:ye(a.values,e,n)}))})},this.deleteField=e=>{let s=[...Object.keys(this.fieldInfo).filter(o=>{let a=e.toString();return o!==a&&o.startsWith(a)}),e];this.baseStore.setState(o=>{let a=l({},o);return s.forEach(d=>{a.values=Pt(a.values,d),delete this.fieldInfo[d],delete a.fieldMetaBase[d]}),a})},this.pushFieldValue=(e,n,s)=>{this.setFieldValue(e,o=>[...Array.isArray(o)?o:[],n],s),this.validateField(e,"change")},this.insertFieldValue=(e,n,s,o)=>C(this,null,function*(){this.setFieldValue(e,a=>[...a.slice(0,n),s,...a.slice(n)],o),yield this.validateField(e,"change"),Me(this).handleArrayFieldMetaShift(e,n,"insert"),yield this.validateArrayFieldsStartingFrom(e,n,"change")}),this.replaceFieldValue=(e,n,s,o)=>C(this,null,function*(){this.setFieldValue(e,a=>a.map((d,m)=>m===n?s:d),o),yield this.validateField(e,"change"),yield this.validateArrayFieldsStartingFrom(e,n,"change")}),this.removeFieldValue=(e,n,s)=>C(this,null,function*(){let o=this.getFieldValue(e),a=Array.isArray(o)?Math.max(o.length-1,0):null;if(this.setFieldValue(e,d=>d.filter((m,f)=>f!==n),s),Me(this).handleArrayFieldMetaShift(e,n,"remove"),a!==null){let d=`${e}[${a}]`;this.deleteField(d)}yield this.validateField(e,"change"),yield this.validateArrayFieldsStartingFrom(e,n,"change")}),this.swapFieldValues=(e,n,s,o)=>{this.setFieldValue(e,a=>{let d=a[n],m=a[s];return ye(ye(a,`${n}`,m),`${s}`,d)},o),Me(this).handleArrayFieldMetaShift(e,n,"swap",s),this.validateField(e,"change"),this.validateField(`${e}[${n}]`,"change"),this.validateField(`${e}[${s}]`,"change")},this.moveFieldValues=(e,n,s,o)=>{this.setFieldValue(e,a=>{let d=[...a];return d.splice(s,0,d.splice(n,1)[0]),d},o),Me(this).handleArrayFieldMetaShift(e,n,"move",s),this.validateField(e,"change"),this.validateField(`${e}[${n}]`,"change"),this.validateField(`${e}[${s}]`,"change")},this.clearFieldValues=(e,n)=>{let s=this.getFieldValue(e),o=Array.isArray(s)?Math.max(s.length-1,0):null;if(this.setFieldValue(e,[],n),o!==null)for(let a=0;a<=o;a++){let d=`${e}[${a}]`;this.deleteField(d)}this.validateField(e,"change")},this.resetField=e=>{this.baseStore.setState(n=>h(l({},n),{fieldMetaBase:h(l({},n.fieldMetaBase),{[e]:de}),values:this.options.defaultValues?ye(n.values,e,oe(this.options.defaultValues,e)):n.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((e,[n,s])=>(Object.keys(s).length&&s.errors.length&&(e[n]={errors:s.errors,errorMap:s.errorMap}),e),{})}),this.parseValuesWithSchema=e=>ne.validate({value:this.state.values,validationSource:"form"},e),this.parseValuesWithSchemaAsync=e=>ne.validateAsync({value:this.state.values,validationSource:"form"},e),this.baseStore=new ie(it(h(l({},i?.defaultState),{values:i?.defaultValues??((r=i?.defaultState)==null?void 0:r.values)}))),this.fieldMetaDerived=new G({deps:[this.baseStore],fn:({prevDepVals:e,currDepVals:n,prevVal:s})=>{var o,a,d;let m=s,f=e?.[0],u=n[0],c=0,v={};for(let p of Object.keys(u.fieldMetaBase)){let S=u.fieldMetaBase[p],b=f?.fieldMetaBase[p],M=m?.[p],V=oe(u.values,p),E=M?.errors;if(!b||S.errorMap!==b.errorMap){E=Object.values(S.errorMap??{}).filter(re=>re!==void 0);let H=(o=this.getFieldInfo(p))==null?void 0:o.instance;H&&!H.options.disableErrorFlat&&(E=E?.flat(1))}let x=!Bt(E??[]),P=!S.isDirty,$=ae(V,oe(this.options.defaultValues,p))||ae(V,(d=(a=this.getFieldInfo(p))==null?void 0:a.instance)==null?void 0:d.options.defaultValue);if(M&&M.isPristine===P&&M.isValid===x&&M.isDefaultValue===$&&M.errors===E&&S===b){v[p]=M,c++;continue}v[p]=h(l({},S),{errors:E,isPristine:P,isValid:x,isDefaultValue:$})}return Object.keys(u.fieldMetaBase).length&&m&&c===Object.keys(u.fieldMetaBase).length?m:v}}),this.store=new G({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:e,currDepVals:n,prevVal:s})=>{var o,a,d,m;let f=s,u=e?.[0],c=n[0],v=n[1],p=Object.values(v).filter(Boolean),S=p.some(w=>w.isValidating),b=p.every(w=>w.isValid),M=p.some(w=>w.isTouched),V=p.some(w=>w.isBlurred),E=p.every(w=>w.isDefaultValue),x=M&&((o=c.errorMap)==null?void 0:o.onMount),P=p.some(w=>w.isDirty),$=!P,H=!!((a=c.errorMap)!=null&&a.onMount||p.some(w=>{var q;return(q=w?.errorMap)==null?void 0:q.onMount})),re=!!S,A=f?.errors??[];(!u||c.errorMap!==u.errorMap)&&(A=Object.values(c.errorMap).reduce((w,q)=>q===void 0?w:q&&Le(q)?(w.push(q.form),w):(w.push(q),w),[]));let fe=A.length===0,me=b&&fe,Ht=this.options.canSubmitWhenInvalid??!1,nt=c.submissionAttempts===0&&!M&&!H||!re&&!c.isSubmitting&&me||Ht,Fe=c.errorMap;if(x&&(A=A.filter(w=>w!==c.errorMap.onMount),Fe=Object.assign(Fe,{onMount:void 0})),f&&u&&f.errorMap===Fe&&f.fieldMeta===this.fieldMetaDerived.state&&f.errors===A&&f.isFieldsValidating===S&&f.isFieldsValid===b&&f.isFormValid===fe&&f.isValid===me&&f.canSubmit===nt&&f.isTouched===M&&f.isBlurred===V&&f.isPristine===$&&f.isDefaultValue===E&&f.isDirty===P&&ae(u,c))return f;let Ne=h(l({},c),{errorMap:Fe,fieldMeta:this.fieldMetaDerived.state,errors:A,isFieldsValidating:S,isFieldsValid:b,isFormValid:fe,isValid:me,canSubmit:nt,isTouched:M,isBlurred:V,isPristine:$,isDefaultValue:E,isDirty:P}),ze=((d=this.options.transform)==null?void 0:d.deps)??[];if(ze.length!==this.prevTransformArray.length||ze.some((w,q)=>w!==this.prevTransformArray[q])){let w=Object.assign({},this,{state:Ne});(m=this.options.transform)==null||m.fn(w),Ne=w.state,this.prevTransformArray=ze}return Ne}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(i||{})}get state(){return this.store.state}runValidator(i){return Pe(i.validate)?ne[i.type](i.value,i.validate):i.validate(i.value)}handleSubmit(i){return C(this,null,function*(){var r,e,n,s,o,a,d,m;if(this.baseStore.setState(u=>h(l({},u),{isSubmitted:!1,submissionAttempts:u.submissionAttempts+1,isSubmitSuccessful:!1})),R(()=>{Object.values(this.fieldInfo).forEach(u=>{u.instance&&(u.instance.state.meta.isTouched||u.instance.setMeta(c=>h(l({},c),{isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(u=>h(l({},u),{isSubmitting:!0}));let f=()=>{this.baseStore.setState(u=>h(l({},u),{isSubmitting:!1}))};if(yield this.validateAllFields("submit"),!this.state.isFieldsValid){f(),(e=(r=this.options).onSubmitInvalid)==null||e.call(r,{value:this.state.values,formApi:this});return}if(yield this.validate("submit"),!this.state.isValid){f(),(s=(n=this.options).onSubmitInvalid)==null||s.call(n,{value:this.state.values,formApi:this});return}R(()=>{Object.values(this.fieldInfo).forEach(u=>{var c,v,p;(p=(v=(c=u.instance)==null?void 0:c.options.listeners)==null?void 0:v.onSubmit)==null||p.call(v,{value:u.instance.state.value,fieldApi:u.instance})})}),(a=(o=this.options.listeners)==null?void 0:o.onSubmit)==null||a.call(o,{formApi:this});try{yield(m=(d=this.options).onSubmit)==null?void 0:m.call(d,{value:this.state.values,formApi:this,meta:i??this.options.onSubmitMeta}),R(()=>{this.baseStore.setState(u=>h(l({},u),{isSubmitted:!0,isSubmitSuccessful:!0})),f()})}catch(u){throw this.baseStore.setState(c=>h(l({},c),{isSubmitSuccessful:!1})),f(),u}})}setErrorMap(i){R(()=>{Object.entries(i).forEach(([r,e])=>{let n=r;if(Le(e)){let{formError:s,fieldErrors:o}=$e(e);for(let a of Object.keys(this.fieldInfo))this.getFieldMeta(a)&&this.setFieldMeta(a,m=>h(l({},m),{errorMap:h(l({},m.errorMap),{[n]:o?.[a]}),errorSourceMap:h(l({},m.errorSourceMap),{[n]:"form"})}));this.baseStore.setState(a=>h(l({},a),{errorMap:h(l({},a.errorMap),{[n]:s})}))}else this.baseStore.setState(s=>h(l({},s),{errorMap:h(l({},s.errorMap),{[n]:e})}))})})}};function $e(t){if(t){if(Le(t)){let i=$e(t.form).formError,r=t.fields;return{formError:i,fieldErrors:r}}return{formError:t}}return{formError:void 0}}function Be(t){switch(t){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var Ve=class{constructor(i){this.options={},this.mount=()=>{var r,e;let n=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});let s=this.getInfo();s.instance=this,this.update(this.options);let{onMount:o}=this.options.validators||{};if(o){let a=this.runValidator({validate:o,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});a&&this.setMeta(d=>h(l({},d),{errorMap:h(l({},d?.errorMap),{onMount:a}),errorSourceMap:h(l({},d?.errorSourceMap),{onMount:"field"})}))}return(e=(r=this.options.listeners)==null?void 0:r.onMount)==null||e.call(r,{value:this.state.value,fieldApi:this}),n},this.update=r=>{this.options=r;let e=this.name!==r.name;if(this.name=r.name,this.state.value===void 0){let n=oe(r.form.options.defaultValues,r.name),s=r.defaultValue??n;e?this.setValue(o=>o||s,{dontUpdateMeta:!0}):s!==void 0&&this.setValue(s,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(r,e)=>{this.form.setFieldValue(this.name,r,e),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=r=>this.form.setFieldMeta(this.name,r),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(r,e)=>{this.form.pushFieldValue(this.name,r,e),this.triggerOnChangeListener()},this.insertValue=(r,e,n)=>{this.form.insertFieldValue(this.name,r,e,n),this.triggerOnChangeListener()},this.replaceValue=(r,e,n)=>{this.form.replaceFieldValue(this.name,r,e,n),this.triggerOnChangeListener()},this.removeValue=(r,e)=>{this.form.removeFieldValue(this.name,r,e),this.triggerOnChangeListener()},this.swapValues=(r,e,n)=>{this.form.swapFieldValues(this.name,r,e,n),this.triggerOnChangeListener()},this.moveValue=(r,e,n)=>{this.form.moveFieldValues(this.name,r,e,n),this.triggerOnChangeListener()},this.clearValues=r=>{this.form.clearFieldValues(this.name,r),this.triggerOnChangeListener()},this.getLinkedFields=r=>{let e=Object.values(this.form.fieldInfo),n=[];for(let s of e){if(!s.instance)continue;let{onChangeListenTo:o,onBlurListenTo:a}=s.instance.options.validators||{};r==="change"&&o?.includes(this.name)&&n.push(s.instance),r==="blur"&&a?.includes(this.name)&&n.push(s.instance)}return n},this.validateSync=(r,e)=>{var n;let s=be(r,this.options),a=this.getLinkedFields(r).reduce((f,u)=>{let c=be(r,u.options);return c.forEach(v=>{v.field=u}),f.concat(c)},[]),d=!1;R(()=>{let f=(u,c)=>{var v;let p=Re(c.cause),S=c.validate?Rt(u.runValidator({validate:c.validate,value:{value:u.store.state.value,validationSource:"field",fieldApi:u},type:"validate"})):void 0,b=e[p],{newErrorValue:M,newSource:V}=tt({formLevelError:b,fieldLevelError:S});((v=u.state.meta.errorMap)==null?void 0:v[p])!==M&&u.setMeta(E=>h(l({},E),{errorMap:h(l({},E.errorMap),{[p]:M}),errorSourceMap:h(l({},E.errorSourceMap),{[p]:V})})),M&&(d=!0)};for(let u of s)f(this,u);for(let u of a)u.validate&&f(u.field,u)});let m=Re("submit");return(n=this.state.meta.errorMap)!=null&&n[m]&&r!=="submit"&&!d&&this.setMeta(f=>h(l({},f),{errorMap:h(l({},f.errorMap),{[m]:void 0}),errorSourceMap:h(l({},f.errorSourceMap),{[m]:void 0})})),{hasErrored:d}},this.validateAsync=(r,e)=>C(this,null,function*(){let n=Se(r,this.options),s=yield e,o=this.getLinkedFields(r),a=o.reduce((c,v)=>{let p=Se(r,v.options);return p.forEach(S=>{S.field=v}),c.concat(p)},[]);this.state.meta.isValidating||this.setMeta(c=>h(l({},c),{isValidating:!0}));for(let c of o)c.setMeta(v=>h(l({},v),{isValidating:!0}));let d=[],m=[],f=(c,v,p)=>{let S=Re(v.cause),b=c.getInfo().validationMetaMap[S];b?.lastAbortController.abort();let M=new AbortController;this.getInfo().validationMetaMap[S]={lastAbortController:M},p.push(new Promise(V=>C(this,null,function*(){var E;let x;try{x=yield new Promise((A,fe)=>{this.timeoutIds.validations[v.cause]&&clearTimeout(this.timeoutIds.validations[v.cause]),this.timeoutIds.validations[v.cause]=setTimeout(()=>C(this,null,function*(){if(M.signal.aborted)return A(void 0);try{A(yield this.runValidator({validate:v.validate,value:{value:c.store.state.value,fieldApi:c,signal:M.signal,validationSource:"field"},type:"validateAsync"}))}catch(me){fe(me)}}),v.debounceMs)})}catch(A){x=A}if(M.signal.aborted)return V(void 0);let P=Rt(x),$=(E=s[this.name])==null?void 0:E[S],{newErrorValue:H,newSource:re}=tt({formLevelError:$,fieldLevelError:P});c.setMeta(A=>h(l({},A),{errorMap:h(l({},A?.errorMap),{[S]:H}),errorSourceMap:h(l({},A.errorSourceMap),{[S]:re})})),V(H)})))};for(let c of n)c.validate&&f(this,c,d);for(let c of a)c.validate&&f(c.field,c,m);let u=[];(d.length||m.length)&&(u=yield Promise.all(d),yield Promise.all(m)),this.setMeta(c=>h(l({},c),{isValidating:!1}));for(let c of o)c.setMeta(v=>h(l({},v),{isValidating:!1}));return u.filter(Boolean)}),this.validate=(r,e)=>{var n;if(!this.state.meta.isTouched)return[];let{fieldsErrorMap:s}=e?.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(r),{hasErrored:o}=this.validateSync(r,s[this.name]??{});if(o&&!this.options.asyncAlways)return(n=this.getInfo().validationMetaMap[Re(r)])==null||n.lastAbortController.abort(),this.state.meta.errors;let a=e?.skipFormValidation?Promise.resolve({}):this.form.validateAsync(r);return this.validateAsync(r,a)},this.handleChange=r=>{this.setValue(r)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(e=>h(l({},e),{isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(e=>h(l({},e),{isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=r=>ne.validate({value:this.state.value,validationSource:"field"},r),this.parseValueWithSchemaAsync=r=>ne.validateAsync({value:this.state.value,validationSource:"field"},r),this.form=i.form,this.name=i.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new G({deps:[this.form.store],fn:()=>{let r=this.form.getFieldValue(this.name),e=this.form.getFieldMeta(this.name)??l(l({},de),i.defaultMeta);return{value:r,meta:e}}}),this.options=i}get state(){return this.store.state}runValidator(i){return Pe(i.validate)?ne[i.type](i.value,i.validate):i.validate(i.value)}setErrorMap(i){this.setMeta(r=>h(l({},r),{errorMap:l(l({},r.errorMap),i)}))}triggerOnBlurListener(){var i,r,e,n,s,o;let a=(i=this.form.options.listeners)==null?void 0:i.onBlurDebounceMs;a&&a>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var m,f;(f=(m=this.form.options.listeners)==null?void 0:m.onBlur)==null||f.call(m,{formApi:this.form,fieldApi:this})},a)):(e=(r=this.form.options.listeners)==null?void 0:r.onBlur)==null||e.call(r,{formApi:this.form,fieldApi:this});let d=(n=this.options.listeners)==null?void 0:n.onBlurDebounceMs;d&&d>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var m,f;(f=(m=this.options.listeners)==null?void 0:m.onBlur)==null||f.call(m,{value:this.state.value,fieldApi:this})},d)):(o=(s=this.options.listeners)==null?void 0:s.onBlur)==null||o.call(s,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var i,r,e,n,s,o;let a=(i=this.form.options.listeners)==null?void 0:i.onChangeDebounceMs;a&&a>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var m,f;(f=(m=this.form.options.listeners)==null?void 0:m.onChange)==null||f.call(m,{formApi:this.form,fieldApi:this})},a)):(e=(r=this.form.options.listeners)==null?void 0:r.onChange)==null||e.call(r,{formApi:this.form,fieldApi:this});let d=(n=this.options.listeners)==null?void 0:n.onChangeDebounceMs;d&&d>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var m,f;(f=(m=this.options.listeners)==null?void 0:m.onChange)==null||f.call(m,{value:this.state.value,fieldApi:this})},d)):(o=(s=this.options.listeners)==null?void 0:s.onChange)==null||o.call(s,{value:this.state.value,fieldApi:this})}};function Rt(t){if(t)return t}function Re(t){switch(t){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}function We(t,i=e=>e,r={equal:mi}){return!r.injector&&Ge(We),r.injector||(r.injector=k(He)),at(r.injector,()=>{let e=k(we),n=Mt(()=>i(t.state),r),s=t.subscribe(()=>{n.set(i(t.state))});return e.onDestroy(()=>{s()}),n.asReadonly()})}function mi(t,i){if(Object.is(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;if(t instanceof Map&&i instanceof Map){if(t.size!==i.size)return!1;for(let[e,n]of t)if(!i.has(e)||!Object.is(n,i.get(e)))return!1;return!0}if(t instanceof Set&&i instanceof Set){if(t.size!==i.size)return!1;for(let e of t)if(!i.has(e))return!1;return!0}let r=Object.keys(t);if(r.length!==Object.keys(i).length)return!1;for(let e=0;e<r.length;e++)if(!Object.prototype.hasOwnProperty.call(i,r[e])||!Object.is(t[r[e]],i[r[e]]))return!1;return!0}function Ue(t){let i=new _e(t);return We(i.store,r=>r.isSubmitting),i}var Ke=(()=>{class t{name;defaultValue;asyncDebounceMs;asyncAlways;tanstackField;validators;listeners;defaultMeta;disableErrorFlat;api;getOptions(){return{defaultValue:this.defaultValue,asyncDebounceMs:this.asyncDebounceMs,asyncAlways:this.asyncAlways,disableErrorFlat:this.disableErrorFlat,validators:this.validators,listeners:this.listeners,defaultMeta:this.defaultMeta,name:this.name,form:this.tanstackField}}unmount;ngOnInit(){this.api=new Ve(this.getOptions()),this.unmount=this.api.mount()}ngOnDestroy(){this.unmount?.()}ngOnChanges(){let r=this.api;r&&r.update(this.getOptions())}static \u0275fac=function(e){return new(e||t)};static \u0275dir=ft({type:t,selectors:[["","tanstackField",""]],inputs:{name:"name",defaultValue:"defaultValue",asyncDebounceMs:[2,"asyncDebounceMs","asyncDebounceMs",_t],asyncAlways:[2,"asyncAlways","asyncAlways",ke],tanstackField:"tanstackField",validators:"validators",listeners:"listeners",defaultMeta:"defaultMeta",disableErrorFlat:"disableErrorFlat"},exportAs:["field"],features:[dt]})}return t})();function Wt(t,i){return We(t.store,i)}function hi(t,i){if(t&1){let r=ee();g(0,"div",3)(1,"div",4)(2,"div",5)(3,"h2",6),_(4,"Add a New Course"),y(),g(5,"form",7),j("submit",function(n){I(r);let s=L();return O(s.handleSubmit(n))}),le(6,8,0),g(8,"div",9)(9,"label",10)(10,"span",11),_(11,"Course Title"),y()(),g(12,"input",12),j("input",function(n){I(r);let s=W(7);return O(s.api.handleChange(n.target.value))}),y()(),ce(),le(13,13,1),g(15,"div",9)(16,"label",10)(17,"span",11),_(18,"Description"),y()(),g(19,"textarea",14),j("input",function(n){I(r);let s=W(14);return O(s.api.handleChange(n.target.value))}),y()(),ce(),le(20,15,2),g(22,"div",16)(23,"label",10)(24,"span",11),_(25,"Duration (Days)"),y()(),g(26,"input",17),j("input",function(n){I(r);let s=W(21);return O(s.api.handleChange(+n.target.value))}),y()(),ce(),g(27,"div",18)(28,"button",19),lt(),g(29,"svg",20),z(30,"path",21),y(),_(31," Add Course "),y()()()()()()}if(t&2){let r=W(7),e=W(14),n=W(21),s=L();F(6),D("tanstackField",s.form),F(3),D("for",r.api.name),F(3),D("id",r.api.name)("name",r.api.name)("value",r.api.state.value),F(),D("tanstackField",s.form),F(3),D("for",e.api.name),F(3),D("id",e.api.name)("name",e.api.name)("value",e.api.state.value),F(),D("tanstackField",s.form),F(3),D("for",n.api.name),F(3),D("id",n.api.name)("name",n.api.name)("value",n.api.state.value)}}function pi(t,i){t&1&&(g(0,"div",3)(1,"div",4)(2,"div",5)(3,"h2",6),_(4,"Submitting..."),y(),g(5,"p",22),_(6,"Please wait while we add your course."),y()()()())}var Ut=(()=>{let i=class i{constructor(){this.store=k(U),this.form=Ue({defaultValues:{title:"",description:"",numberOfDays:0},onSubmit:n=>C(this,[n],function*({value:e}){console.log("Submitted values:",e),yield this.store.addCourse(e),this.form.reset()})}),this.isSubmitting=Wt(this.form,e=>e.isSubmitting)}handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.form.handleSubmit()}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses-add"]],decls:2,vars:1,consts:[["title","field"],["description","field"],["numberOfDays","field"],[1,"max-w-2xl","mx-auto","p-6"],[1,"card","bg-base-100","shadow-xl"],[1,"card-body"],[1,"card-title","text-2xl","mb-6"],[1,"space-y-6",3,"submit"],["name","title",3,"tanstackField"],[1,"form-control","w-full"],[1,"label",3,"for"],[1,"label-text","font-medium"],["type","text","placeholder","Enter course title",1,"input","input-bordered","w-full",3,"input","id","name","value"],["name","description",3,"tanstackField"],["placeholder","Enter course description",1,"textarea","textarea-bordered","w-full","h-24",3,"input","id","name","value"],["name","numberOfDays",3,"tanstackField"],[1,"form-control","w-full","max-w-xs"],["type","number","min","0","placeholder","0",1,"input","input-bordered","w-full","max-w-xs",3,"input","id","name","value"],[1,"card-actions","justify-end","pt-4"],["type","submit",1,"btn","btn-primary","btn-wide"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"h-5","w-5","mr-2"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 4v16m8-8H4"],[1,"text-sm"]],template:function(n,s){n&1&&K(0,hi,32,15,"div",3)(1,pi,7,0,"div",3),n&2&&N(s.isSubmitting()===!1?0:1)},dependencies:[Ke],encapsulation:2,changeDetection:0});let t=i;return t})();var vi=t=>["..","details",t],gi=()=>["..","add"],yi=(t,i)=>i.id;function Si(t,i){t&1&&(g(0,"div",0)(1,"p",1),_(2,"Error loading courses!"),y(),g(3,"p"),_(4,"Perhaps you haven't implemented the API Yet?"),y()())}function bi(t,i){t&1&&(g(0,"p"),_(1,"Loading courses..."),y())}function Mi(t,i){if(t&1&&(g(0,"p",8),_(1),y()),t&2){let r=L().$implicit;F(),Q("Instructor: ",r.instructor)}}function _i(t,i){t&1&&(g(0,"p",8),_(1,"Instructor: Unknown"),y())}function Vi(t,i){if(t&1&&(g(0,"li",4)(1,"div",5)(2,"div",6)(3,"h2",7),_(4),y(),g(5,"p"),_(6),y(),K(7,Mi,2,1,"p",8)(8,_i,2,0,"p",8),g(9,"p"),_(10),y(),g(11,"div",9),z(12,"app-link-button",10),y()()()()),t&2){let r=i.$implicit;F(4),Y(r.title),F(2),Y(r.description),F(),N(r.instructor?7:8),F(3),Q("",r.numberOfDays," days"),F(2),D("link",bt(5,vi,r.id))}}function Fi(t,i){t&1&&(g(0,"li"),z(1,"app-link-button",11),y()),t&2&&(F(),D("link",St(1,gi)))}function wi(t,i){if(t&1&&(g(0,"h1",2),_(1,"Courses List"),y(),g(2,"ul",3),mt(3,Vi,13,7,"li",4,yi,!1,Fi,2,2,"li"),y()),t&2){let r=L();F(3),ht(r.store.courses())}}var Kt=(()=>{let i=class i{constructor(){this.store=k(U)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses-list"]],decls:3,vars:1,consts:[[1,"alert","alert-error"],[1,"text-xl"],[1,"text-2xl","font-bold","mb-4"],[1,"flex","flex-auto","flex-wrap","gap-4","justify-center"],[1,"w-1/4"],[1,"card","bg-accent-content","shadow-xl"],[1,"card-body"],[1,"card-title"],[1,"text-sm"],[1,"card-actions","justify-end"],["makeActive","","label","View Details",3,"link"],["label","No Courses Available. Add One?","makeActive","",3,"link"]],template:function(n,s){n&1&&K(0,Si,5,0,"div",0)(1,bi,2,0,"p")(2,wi,6,1),n&2&&N(s.store.error()?0:s.store.isLoading()?1:2)},dependencies:[Te],encapsulation:2,changeDetection:0});let t=i;return t})();var Ci=["modal"],Nt=(()=>{let i=class i{constructor(){this.modal=xe("modal"),this.course=J.required(),this.deleted=Ae(),this.store=k(U)}cancel(){let e=this.modal();e&&e.nativeElement.close()}delete(){return C(this,null,function*(){yield this.store.delete(this.course().id),this.deleted.emit()})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses-delete"]],viewQuery:function(n,s){n&1&&Ce(s.modal,Ci,5),n&2&&Ee()},inputs:{course:[1,"course"]},outputs:{deleted:"deleted"},decls:14,vars:1,consts:[["modal",""],["onclick","my_modal_1.showModal()",1,"btn","btn-error","btn-sm"],["id","my_modal_1",1,"modal"],[1,"modal-box"],[1,"text-lg","font-bold"],[1,"py-4"],[1,"modal-action"],[1,"btn","btn-error",3,"click"],[1,"btn","btn-primary",3,"click"]],template:function(n,s){if(n&1){let o=ee();g(0,"button",1),_(1," Delete Course "),y(),g(2,"dialog",2,0)(4,"div",3)(5,"h3",4),_(6),y(),g(7,"p",5),_(8,"Press ESC key or click the button below to close"),y(),g(9,"div",6)(10,"button",7),j("click",function(){return I(o),O(s.cancel())}),_(11,"Cancel"),y(),g(12,"button",8),j("click",function(){return I(o),O(s.delete())}),_(13,"Delete"),y()()()()}n&2&&(F(6),Q("Delete ",s.course().title))},encapsulation:2,changeDetection:0});let t=i;return t})();var Ei=["assignModal"],zt=(()=>{let i=class i{constructor(){this.modal=xe("assignModal"),this.course=J.required(),this.instructorAssigned=Ae(),this.store=k(U),this.form=Ue({defaultValues:{instructor:""},onSubmit:n=>C(this,[n],function*({value:e}){let s=this.course();s&&(yield this.store.assignInstructor(s.id,e.instructor)),this.instructorAssigned.emit(),this.cancel()})}),he(()=>{let e=this.course();e&&this.form.setFieldValue("instructor",e.instructor||"")})}cancel(){let e=this.modal();e&&e.nativeElement.close()}handleSubmit(e){e.preventDefault(),e.stopPropagation(),this.form.handleSubmit()}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses-assign-instructor"]],viewQuery:function(n,s){n&1&&Ce(s.modal,Ei,5),n&2&&Ee()},inputs:{course:[1,"course"]},outputs:{instructorAssigned:"instructorAssigned"},decls:25,vars:2,consts:[["assignModal",""],["instructor","field"],["onclick","assign_modal.showModal()",1,"btn","btn-primary","btn-sm"],["id","assign_modal",1,"modal"],[1,"modal-box"],[1,"text-lg","font-bold","mb-2"],[1,"divider","my-2"],[1,"modal-action","flex","flex-col"],[1,"w-full","space-y-4",3,"submit"],["name","instructor",3,"tanstackField"],[1,"form-control","w-full"],["for","instructor",1,"label"],[1,"label-text","font-medium"],["id","instructor","type","text","placeholder","Enter instructor's full name","autocomplete","name",1,"input","input-bordered","w-full","focus:input-primary",3,"input","value"],[1,"flex","justify-end","gap-2","mt-6"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary"],["method","dialog",1,"modal-backdrop"]],template:function(n,s){if(n&1){let o=ee();g(0,"button",2),_(1," Assign Instructor "),y(),g(2,"dialog",3,0)(4,"div",4)(5,"h3",5),_(6,"Assign An Instructor"),y(),z(7,"div",6),g(8,"div",7)(9,"form",8),j("submit",function(d){return I(o),O(s.handleSubmit(d))}),le(10,9,1),g(12,"div",10)(13,"label",11)(14,"span",12),_(15,"Instructor Name"),y()(),g(16,"input",13),j("input",function(d){I(o);let m=W(11);return O(m.api.handleChange(d.target.value))}),y()(),ce(),g(17,"div",14)(18,"button",15),j("click",function(){return I(o),O(s.cancel())}),_(19," Cancel "),y(),g(20,"button",16),_(21," Assign Instructor "),y()()()()(),g(22,"form",17)(23,"button"),_(24,"close"),y()()()}if(n&2){let o=W(11);F(10),D("tanstackField",s.form),F(6),D("value",o.api.state.value)}},dependencies:[Ke],encapsulation:2,changeDetection:0});let t=i;return t})();function Di(t,i){t&1&&(g(0,"p"),_(1,"Loading..."),y())}function Ai(t,i){t&1&&(g(0,"p"),_(1,"Error loading course details"),y())}function xi(t,i){if(t&1&&(g(0,"p",3),_(1),y()),t&2){L();let r=yt(0);F(),Q("Instructor: ",r.instructor)}}function ki(t,i){t&1&&(g(0,"p",3),_(1,"Instructor: Unknown"),y())}function Ti(t,i){if(t&1){let r=ee();vt(0),g(1,"h2",2),_(2),y(),g(3,"p"),_(4),y(),K(5,xi,2,1,"p",3)(6,ki,2,0,"p",3),g(7,"p"),_(8),y(),g(9,"div",4)(10,"app-courses-delete",5),j("deleted",function(){I(r);let n=L();return O(n.onDeleted())}),y(),g(11,"app-courses-assign-instructor",6),j("instructorAssigned",function(){I(r);let n=L();return O(n.onInstructorAssigned())}),y()()}if(t&2){let r=L(),e=gt(r.course.value());F(2),Y(e.title),F(2),Y(e.description),F(),N(e.instructor?5:6),F(3),Q("",e.numberOfDays," days"),F(2),D("course",r.course.value()),F(),D("course",r.course.value())}}var Gt=(()=>{let i=class i{constructor(){this.id=J.required(),this.router=k(Ft),this.course=De({params:()=>({id:this.id()}),loader:({params:e})=>fetch(`/api/courses/${e.id}`).then(n=>n.json())})}onDeleted(){this.router.navigate(["/courses"])}onInstructorAssigned(){this.course.reload()}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=T({type:i,selectors:[["app-courses-details"]],inputs:{id:[1,"id"]},decls:5,vars:1,consts:[[1,"card","bg-base-100","shadow-xl"],[1,"card-body"],[1,"card-title"],[1,"text-sm"],[1,"card-actions","justify-end"],[3,"deleted","course"],[3,"instructorAssigned","course"]],template:function(n,s){n&1&&(g(0,"div",0)(1,"div",1),K(2,Di,2,0,"p")(3,Ai,2,0,"p")(4,Ti,12,7),y()()),n&2&&(F(2),N(s.course.isLoading()?2:s.course.error()?3:4))},dependencies:[Nt,zt],encapsulation:2,changeDetection:0});let t=i;return t})();var xr=[{path:"",component:Ot,providers:[U],children:[{path:"add",component:Ut},{path:"list",component:Kt},{path:"details/:id",component:Gt},{path:"**",redirectTo:"list"}]}];export{xr as COURSES_ROUTES};
